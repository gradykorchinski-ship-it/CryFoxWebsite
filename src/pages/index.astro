---
// src/pages/index.astro
import "../styles/global.css";
import logo from "../images/logo.png?url";

const brand = {
  name: "CryFox",
  tagline: "A modern browser built for power users.",
};

const nav = [
  { label: "Features", href: "/features", keywords: "features performance engine ui tabs" },
  { label: "Privacy", href: "/privacy", keywords: "privacy tracking protection fingerprinting" },
  { label: "Support", href: "/support", keywords: "support help docs faq" },
];

const ctas = [
  { label: "Download", href: "/download", keywords: "download install windows mac linux" },
];
---

<!doctype html>
<html lang="en" class="bg-zinc-950 text-zinc-100">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{brand.name} — {brand.tagline}</title>
    <meta name="description" content={`${brand.name}: ${brand.tagline}`} />
  </head>

  <body class="min-h-screen">
    <!-- Background glow layers -->
    <div aria-hidden="true" class="pointer-events-none fixed inset-0 -z-10 overflow-hidden">
      <div class="absolute -top-48 left-1/2 h-[620px] w-[620px] -translate-x-1/2 rounded-full bg-violet-500/20 blur-3xl"></div>
      <div class="absolute top-24 left-8 h-[420px] w-[420px] rounded-full bg-sky-500/10 blur-3xl"></div>
      <div class="absolute bottom-0 right-0 h-[520px] w-[520px] rounded-full bg-fuchsia-500/10 blur-3xl"></div>
      <div class="absolute inset-0 bg-gradient-to-b from-zinc-950 via-zinc-950/70 to-zinc-950"></div>
      <div class="absolute inset-0 opacity-[0.08] [background-image:radial-gradient(circle_at_1px_1px,white_1px,transparent_0)] [background-size:22px_22px]"></div>
    </div>

    <!-- Header -->
    <header class="sticky top-0 z-40 border-b border-white/10 bg-zinc-950/60 backdrop-blur">
      <div class="mx-auto flex max-w-6xl items-center justify-between px-4 py-3">
        <a href="/" class="flex items-center gap-3">
          <img src={logo} alt="CryFox logo" class="h-7 w-7 object-contain" />
          <div class="leading-tight">
            <div class="font-semibold tracking-tight">{brand.name}</div>
            <div class="text-xs text-zinc-400">Fast • Private • Yours</div>
          </div>
        </a>

        <!-- Desktop nav -->
        <nav class="hidden items-center gap-6 text-sm text-zinc-200 md:flex">
          {nav.map((item) => (
            <a class="hover:text-white/90 text-zinc-300" href={item.href}>{item.label}</a>
          ))}

          <button
            id="cmdkBtn"
            class="rounded-lg border border-white/10 bg-white/5 px-3 py-1.5 text-xs text-zinc-200 hover:bg-white/10"
            type="button"
            title="Search (Ctrl/⌘+K)"
          >
            Search <span class="ml-2 text-zinc-400">Ctrl/⌘ K</span>
          </button>

          <a
            class="rounded-lg bg-violet-500 px-4 py-2 font-semibold text-zinc-950 hover:bg-violet-400"
            href="/download"
          >
            Download
          </a>
        </nav>

        <button id="menuBtn" class="md:hidden rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-sm" type="button">
          Menu
        </button>
      </div>

      <!-- Mobile menu -->
      <div id="mobileMenu" class="hidden md:hidden border-t border-white/10 bg-zinc-950/80 backdrop-blur">
        <div class="mx-auto max-w-6xl px-4 py-3 space-y-2 text-sm">
          {nav.map((item) => (
            <a class="mobileLink block rounded-lg px-3 py-2 hover:bg-white/5" href={item.href}>{item.label}</a>
          ))}
          <a class="mobileLink block rounded-lg bg-violet-500 px-3 py-2 font-semibold text-zinc-950 hover:bg-violet-400" href="/download">
            Download
          </a>
        </div>
      </div>
    </header>

    <main>
      <!-- Hero -->
      <section class="mx-auto max-w-6xl px-4 pt-14 pb-10 md:pt-20">
        <div class="grid items-center gap-10 md:grid-cols-2">
          <div>
            <div class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs text-zinc-300">
              <span class="h-2 w-2 rounded-full bg-emerald-400"></span>
              New build channel available
            </div>

            <h1 class="mt-5 text-4xl font-semibold tracking-tight md:text-5xl">
              Browse
              <span class="relative">
                <span id="rotator" class="bg-gradient-to-r from-violet-300 to-fuchsia-200 bg-clip-text text-transparent">privately</span>
              </span>
              <br class="hidden md:block" />
              without giving up speed.
            </h1>

            <p class="mt-4 text-zinc-300 leading-relaxed">
              {brand.name} is a performance-first, privacy-respecting browser for people who actually tweak settings,
              open 37 tabs, and notice latency.
            </p>

            <div class="mt-7 flex flex-wrap gap-3">
              <a class="rounded-xl bg-violet-500 px-5 py-3 font-semibold text-zinc-950 hover:bg-violet-400" href="/download">
                Download
              </a>
              <a class="rounded-xl border border-white/10 bg-white/5 px-5 py-3 font-semibold text-zinc-100 hover:bg-white/10" href="/features">
                Explore features
              </a>
            </div>

            <div class="mt-4 text-xs text-zinc-400">
              No account required • Import from Firefox/Chrome • Open-source friendly
            </div>
          </div>

          <!-- “Screenshot” card (stylized placeholder) -->
          <div class="relative">
            <div class="rounded-2xl border border-white/10 bg-gradient-to-b from-white/10 to-white/5 p-4 shadow-2xl">
              <div class="flex items-center gap-2 pb-3">
                <div class="h-3 w-3 rounded-full bg-red-400/80"></div>
                <div class="h-3 w-3 rounded-full bg-yellow-400/80"></div>
                <div class="h-3 w-3 rounded-full bg-green-400/80"></div>
                <div class="ml-3 h-6 flex-1 rounded-lg bg-black/30"></div>
              </div>

              <div class="grid gap-3">
                <div class="rounded-xl border border-white/10 bg-black/30 p-4">
                  <div class="h-3 w-1/3 rounded bg-white/10"></div>
                  <div class="mt-3 h-2 w-5/6 rounded bg-white/10"></div>
                  <div class="mt-2 h-2 w-2/3 rounded bg-white/10"></div>
                  <div class="mt-6 grid grid-cols-3 gap-3">
                    <div class="h-20 rounded-lg bg-white/5 border border-white/10"></div>
                    <div class="h-20 rounded-lg bg-white/5 border border-white/10"></div>
                    <div class="h-20 rounded-lg bg-white/5 border border-white/10"></div>
                  </div>
                </div>

                <div class="grid grid-cols-2 gap-3">
                  <div class="rounded-xl border border-white/10 bg-black/30 p-4">
                    <div class="h-3 w-1/2 rounded bg-white/10"></div>
                    <div class="mt-3 h-2 w-4/5 rounded bg-white/10"></div>
                    <div class="mt-2 h-2 w-3/5 rounded bg-white/10"></div>
                  </div>
                  <div class="rounded-xl border border-white/10 bg-black/30 p-4">
                    <div class="h-3 w-2/5 rounded bg-white/10"></div>
                    <div class="mt-3 h-2 w-5/6 rounded bg-white/10"></div>
                    <div class="mt-2 h-2 w-2/3 rounded bg-white/10"></div>
                  </div>
                </div>
              </div>
            </div>

            <div class="absolute -bottom-6 -left-6 -z-10 h-40 w-40 rounded-full bg-violet-500/20 blur-3xl"></div>
            <div class="absolute -top-10 -right-10 -z-10 h-52 w-52 rounded-full bg-fuchsia-500/20 blur-3xl"></div>
          </div>
        </div>
      </section>

      <!-- Feature grid -->
      <section class="mx-auto max-w-6xl px-4 py-14">
        <div class="flex items-end justify-between gap-6">
          <div>
            <h2 class="text-2xl font-semibold tracking-tight">Built for the “I actually care” crowd</h2>
            <p class="mt-2 text-zinc-300">Speed, privacy, and control — without turning your browser into a science project.</p>
          </div>
        </div>

        <div class="mt-8 grid gap-4 md:grid-cols-2 lg:grid-cols-4">
          <div class="rounded-2xl border border-white/10 bg-white/5 p-6 hover:bg-white/7">
            <div class="text-sm font-semibold">Privacy defaults</div>
            <p class="mt-2 text-sm text-zinc-300">Sane tracking protection out of the box. No spooky surprise “features.”</p>
          </div>
          <div class="rounded-2xl border border-white/10 bg-white/5 p-6">
            <div class="text-sm font-semibold">Fast UI + engine</div>
            <p class="mt-2 text-sm text-zinc-300">Snappy navigation, smooth scrolling, and tuned caching behavior.</p>
          </div>
          <div class="rounded-2xl border border-white/10 bg-white/5 p-6">
            <div class="text-sm font-semibold">Power-user knobs</div>
            <p class="mt-2 text-sm text-zinc-300">Profiles, container-like separation, and “don’t touch my settings” control.</p>
          </div>
          <div class="rounded-2xl border border-white/10 bg-white/5 p-6">
            <div class="text-sm font-semibold">Extension-friendly</div>
            <p class="mt-2 text-sm text-zinc-300">Keep the ecosystem. Add blockers, dev tools, and workflows you already use.</p>
          </div>
        </div>

        <div class="mt-8 flex flex-wrap gap-3">
          <a class="rounded-xl border border-white/10 bg-white/5 px-5 py-3 font-semibold text-zinc-100 hover:bg-white/10" href="/features">
            See all features
          </a>
          <a class="rounded-xl border border-white/10 bg-white/5 px-5 py-3 font-semibold text-zinc-100 hover:bg-white/10" href="/privacy">
            Privacy details
          </a>
        </div>
      </section>

      <!-- “Tabbed” showcase -->
      <section class="mx-auto max-w-6xl px-4 pb-16">
        <div class="rounded-3xl border border-white/10 bg-gradient-to-b from-white/8 to-white/4 p-6 md:p-10">
          <div class="grid gap-10 md:grid-cols-2">
            <div>
              <h2 class="text-2xl font-semibold tracking-tight">Control without chaos</h2>
              <p class="mt-2 text-zinc-300">
                The point is not to add 9,000 toggles — it’s to expose the ones that matter, and make them understandable.
              </p>

              <div class="mt-6 space-y-3">
                <button class="tabBtn w-full rounded-2xl border border-white/10 bg-white/5 p-4 text-left hover:bg-white/10" data-tab="0" type="button">
                  <div class="font-semibold">Private browsing that’s actually private</div>
                  <div class="mt-1 text-sm text-zinc-300">Less leakage, fewer identifiers, smarter defaults.</div>
                </button>

                <button class="tabBtn w-full rounded-2xl border border-white/10 bg-white/5 p-4 text-left hover:bg-white/10" data-tab="1" type="button">
                  <div class="font-semibold">Performance you can feel</div>
                  <div class="mt-1 text-sm text-zinc-300">Page loads + UI response tuned to stay crisp under load.</div>
                </button>

                <button class="tabBtn w-full rounded-2xl border border-white/10 bg-white/5 p-4 text-left hover:bg-white/10" data-tab="2" type="button">
                  <div class="font-semibold">Compatible, not compromised</div>
                  <div class="mt-1 text-sm text-zinc-300">Keep sites working while cutting out the worst tracking behavior.</div>
                </button>
              </div>
            </div>

            <div class="relative">
              <div class="rounded-2xl border border-white/10 bg-black/30 p-6">
                <div class="text-xs text-zinc-400">Showcase</div>

                <div class="mt-4 space-y-4">
                  <div class="tabPanel">
                    <div class="text-lg font-semibold">Private mode</div>
                    <p class="mt-1 text-sm text-zinc-300">Blocks common trackers, reduces fingerprinting surface, and keeps storage tighter.</p>
                    <div class="mt-4 grid grid-cols-2 gap-3">
                      <div class="h-20 rounded-xl border border-white/10 bg-white/5"></div>
                      <div class="h-20 rounded-xl border border-white/10 bg-white/5"></div>
                    </div>
                  </div>

                  <div class="tabPanel hidden">
                    <div class="text-lg font-semibold">Performance mode</div>
                    <p class="mt-1 text-sm text-zinc-300">Aggressive idle tab management, smooth rendering, and fewer UI stalls.</p>
                    <div class="mt-4 h-44 rounded-2xl border border-white/10 bg-white/5"></div>
                  </div>

                  <div class="tabPanel hidden">
                    <div class="text-lg font-semibold">Compatibility mode</div>
                    <p class="mt-1 text-sm text-zinc-300">Smart protections that adapt when a site breaks — with clear control.</p>
                    <div class="mt-4 grid gap-3">
                      <div class="h-14 rounded-xl border border-white/10 bg-white/5"></div>
                      <div class="h-14 rounded-xl border border-white/10 bg-white/5"></div>
                      <div class="h-14 rounded-xl border border-white/10 bg-white/5"></div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="absolute -bottom-10 -right-10 -z-10 h-56 w-56 rounded-full bg-sky-500/15 blur-3xl"></div>
            </div>
          </div>
        </div>
      </section>

      <!-- CTA -->
      <section class="mx-auto max-w-6xl px-4 pb-20">
        <div class="rounded-3xl border border-white/10 bg-white/5 p-8 md:p-12 flex flex-col gap-6 md:flex-row md:items-center md:justify-between">
          <div>
            <h2 class="text-2xl font-semibold tracking-tight">Ready to ship your browser site?</h2>
            <p class="mt-2 text-zinc-300">Index is the landing page — the rest are proper routes now.</p>
          </div>
          <div class="flex gap-3">
            <a class="rounded-xl bg-violet-500 px-5 py-3 font-semibold text-zinc-950 hover:bg-violet-400" href="/download">Download</a>
            <a class="rounded-xl border border-white/10 bg-white/5 px-5 py-3 font-semibold text-zinc-100 hover:bg-white/10" href="/support">Read docs</a>
          </div>
        </div>
      </section>
    </main>

    <footer class="border-t border-white/10 bg-zinc-950/60">
      <div class="mx-auto max-w-6xl px-4 py-10 text-sm text-zinc-400">
        <div class="flex flex-col gap-2 md:flex-row md:items-center md:justify-between">
          <div>© {new Date().getFullYear()} {brand.name}. Built with Astro + Tailwind.</div>
          <div class="flex gap-4">
            <a class="hover:text-zinc-200" href="/privacy">Privacy</a>
            <a class="hover:text-zinc-200" href="/support">Support</a>
            <a class="hover:text-zinc-200" href="#">GitHub</a>
          </div>
        </div>
      </div>
    </footer>

    <!-- Command palette modal -->
    <div id="cmdk" class="fixed inset-0 z-50 hidden" aria-hidden="true">
      <button
        id="cmdkOverlay"
        type="button"
        class="absolute inset-0 bg-black/60 backdrop-blur-sm"
        aria-label="Close search"
      ></button>

      <div
        class="cmdkPanel absolute left-1/2 top-24 w-[min(680px,92vw)] -translate-x-1/2 overflow-hidden rounded-2xl border border-white/10 bg-zinc-950 shadow-2xl"
        role="dialog"
        aria-modal="true"
        aria-label="Site search"
      >
        <div class="border-b border-white/10 p-3">
          <input
            id="cmdkInput"
            class="w-full rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-sm text-zinc-100 outline-none placeholder:text-zinc-500"
            placeholder="Search pages… (Esc to close)"
            autocomplete="off"
          />
        </div>

        <div id="cmdkList" class="p-2 max-h-[320px] overflow-auto">
          {[...nav, ...ctas].map((item) => (
            <a
              class="cmdkItem block rounded-xl px-4 py-3 text-sm hover:bg-white/5"
              href={item.href}
              data-cmdk-item
              data-search={item.keywords}
            >
              {item.label}
            </a>
          ))}

          <div id="cmdkEmpty" class="hidden px-4 py-3 text-sm text-zinc-400">
            No results.
          </div>
        </div>
      </div>
    </div>

    <script>
      // Hero word rotator
      const words = ["privately", "smoothly", "confidently", "fast"];
      let i = 0;
      const rotator = document.getElementById("rotator");
      setInterval(() => {
        i = (i + 1) % words.length;
        if (rotator) rotator.textContent = words[i];
      }, 1800);

      // Mobile menu toggle + close on link click
      const menuBtn = document.getElementById("menuBtn");
      const mobileMenu = document.getElementById("mobileMenu");
      menuBtn?.addEventListener("click", () => mobileMenu?.classList.toggle("hidden"));
      document.querySelectorAll(".mobileLink").forEach((a) => {
        a.addEventListener("click", () => mobileMenu?.classList.add("hidden"));
      });

      // Cmd/K palette
      const cmdk = document.getElementById("cmdk");
      const cmdkBtn = document.getElementById("cmdkBtn");
      const cmdkOverlay = document.getElementById("cmdkOverlay");
      const cmdkInput = document.getElementById("cmdkInput");
      const cmdkList = document.getElementById("cmdkList");
      const cmdkEmpty = document.getElementById("cmdkEmpty");

      const getItems = () => Array.from(cmdkList?.querySelectorAll("[data-cmdk-item]") ?? []);
      let activeIndex = -1;

      const isOpen = () => cmdk && !cmdk.classList.contains("hidden");

      const setOpen = (open) => {
        if (!cmdk) return;
        cmdk.classList.toggle("hidden", !open);
        cmdk.setAttribute("aria-hidden", open ? "false" : "true");

        if (open) {
          activeIndex = -1;
          if (cmdkInput) {
            cmdkInput.value = "";
            setTimeout(() => cmdkInput.focus(), 0);
          }
          updateCmdk("");
        }
      };

      const openCmdk = () => setOpen(true);
      const closeCmdk = () => setOpen(false);

      const isVisible = (el) => !el.classList.contains("hidden");

      const setActive = (el) => {
        getItems().forEach((item) => item.classList.remove("bg-white/10"));
        if (!el) return;
        el.classList.add("bg-white/10");
        el.scrollIntoView({ block: "nearest" });
      };

      const updateCmdk = (query) => {
        const q = (query || "").trim().toLowerCase();
        const items = getItems();

        let any = false;
        items.forEach((a) => {
          const label = (a.textContent || "").trim().toLowerCase();
          const extra = (a.getAttribute("data-search") || "").toLowerCase();
          const match = q === "" || label.includes(q) || extra.includes(q);

          a.classList.toggle("hidden", !match);
          if (match) any = true;
        });

        cmdkEmpty?.classList.toggle("hidden", any);

        const visible = items.filter(isVisible);
        if (visible.length === 0) {
          activeIndex = -1;
          setActive(null);
          return;
        }

        activeIndex = 0;
        setActive(visible[0]);
      };

      cmdkBtn?.addEventListener("click", openCmdk);
      cmdkOverlay?.addEventListener("click", closeCmdk);

      cmdkList?.addEventListener("click", (e) => {
        const link = e.target.closest?.("[data-cmdk-item]");
        if (!link) return;
        closeCmdk();
      });

      cmdkInput?.addEventListener("input", (e) => updateCmdk(e.target.value));

      cmdkInput?.addEventListener("keydown", (e) => {
        const items = getItems().filter(isVisible);

        if (e.key === "Escape") {
          e.preventDefault();
          closeCmdk();
          return;
        }

        if (e.key === "ArrowDown") {
          e.preventDefault();
          if (items.length === 0) return;
          activeIndex = (activeIndex + 1) % items.length;
          setActive(items[activeIndex]);
          return;
        }

        if (e.key === "ArrowUp") {
          e.preventDefault();
          if (items.length === 0) return;
          activeIndex = (activeIndex - 1 + items.length) % items.length;
          setActive(items[activeIndex]);
          return;
        }

        if (e.key === "Enter") {
          if (items.length === 0) return;
          e.preventDefault();
          const target = items[Math.max(0, activeIndex)];
          if (target) {
            target.click();
            closeCmdk();
          }
          return;
        }
      });

      window.addEventListener("keydown", (e) => {
        const isK = e.key.toLowerCase() === "k";
        if ((e.ctrlKey || e.metaKey) && isK) {
          e.preventDefault();
          openCmdk();
        }
        if (e.key === "Escape" && isOpen()) {
          e.preventDefault();
          closeCmdk();
        }
      });

      // Tabbed showcase
      const tabBtns = Array.from(document.querySelectorAll(".tabBtn"));
      const panels = Array.from(document.querySelectorAll(".tabPanel"));
      const setTab = (idx) => {
        panels.forEach((p, i) => p.classList.toggle("hidden", i !== idx));
        tabBtns.forEach((b, i) => {
          b.classList.toggle("bg-white/10", i === idx);
          b.classList.toggle("border-white/20", i === idx);
        });
      };
      tabBtns.forEach((btn) => btn.addEventListener("click", () => setTab(Number(btn.dataset.tab))));
      setTab(0);
    </script>
  </body>
</html>
